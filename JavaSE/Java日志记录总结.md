# java日志记录总结

本文介绍了一下自己在Java项目中使用log的一些总结，从日志的作用、日志的选用、日志级别介绍、日志记录的一些最佳实践几个方面阐述。

日志的作用

主要作用包括：

1、出问题后定位当时问题

2、显示程序当前运行状态

日志的选用

Java里存在众多的开源日志框架: slf4j, logback, log4j, JCL(Apache Common Logging), JUL(JDK自带的java.util.logging)等。这其中slf4j属于一套简洁的日志API，其并不包含日志的实现(它并不负责日志输出等，JCL也包含API)。

slf4j提供了众多的适配器可以适配其他所有开源日志框架，这样让我们在代码中只需面对slf4j的API，然后可以任意切换日志的实现。你可能会讲我们并不需要切换日志框架这种功能，但是我们项目中需要使用大量的第三方库，而这些第三方库使用的日志框架各不相同，不同的日志框架需要不同的配置，不同的配置会导致日志输出到不同的位置。

一个应用肯定需要将日志level，日志输出等收纳起来统一管理。对于这种情况，我们可以使用slf4j的适配器将第三方库中各种日志的实现接管，接管之后就可以统一配置这些第三方库中使用的日志了。

在这些日志实现框架中又数logback性能最优，所以在选择日志实现的时候推荐使用logback。

日志级别介绍

level 定义简直就是一门艺术,  好的定义应该遵循以下原则:

debug：完整详细的记录流程的关键路径. 应该用于开发人员比较感兴趣的跟踪和调试信息, 生产环境中正常都不会打开debug状态

info：应该简洁明确让管理员确认状态。记录相当重要的，对于最终用户和系统管理员有意义的消息。关键系统参数的回显、后台服务的初始化状态、需要系统管理员知会确认的关键信息都需要使用INFO级别

warn：能清楚的告知所有人发生了什么情况.能引起人的重视，指示潜在问题，但不一定需要处理。

error：系统出现了异常或不期望出现的问题，希望及时得到关注的处理。需要注意的一个点，不是所有的异常都需要记录成error。

日志记录的一些最佳实践

以下可以根据项目实际情况当做规范使用：

1、tomcat配置access日志，记录每次http请求相关信息

2、dubbo配置access日志，记录dubbo consumer和provider的每次请求调用和处理

3、在系统里调用外部的地方，记录请求的接口、参数、返回结果、花费时间、遇到的异常等

4、在系统里出现异常的地方，记录异常的堆栈，如果可以，尽量通过异常的日志能还原当时的情景，比如当时受影响的是哪个用户、传入的变量是什么、处理哪些核心数据引发的异常等等

5、有些代码在编写时就知道很难被执行到或者不希望被执行到、以及一些基本不会走到的else块，这些地方需要记录下核心日志

6、禁止使用 System.out 或 System.error

7、禁止使用 Apache Commons Logging , Java Util Logging，推荐使用slf4j，推荐使用Logback，代码中使用Slf4j记录日志

8、业务日志使用独立的日志配置，不能采用className。举个例子，我之前在qunar做项目时，涉及打通许多第三方管理系统，和每一个第三方的交互的日志都会单独存储到一个日志文件中

9、INFO及以上的系统日志统一输出到Console。在生产环境中如果将系统log切分成多个文件, 是非常不利于问题排查的. 不仅要同时追找多个文件, 还要匹配问题发生的时间点. 最要命的是, 有些异常是被print到 console里的。

10、日志配置Rolling，可以根据实际情况配置按天、按小时进行轮转，生成新的日志文件

11、记录程序状态需要包含发生时间（一般框架里就会带上）、大数据量更新的进度、关键变量及正在做哪些重要事情。

12、不同的日志文件尽量使用同样的格式输出（logback配置同样的pattern）, 这样方便脚本通用及第三方解析

结尾

如何在项目里记录好日志是一门学问，也是一门艺术。这里把自己目前想到的总结一下，欢迎指正，也欢迎有更多的最佳实践能分享出来。

作者：Jimin

链接：https://www.imooc.com/article/21178

来源：慕课网

本文原创发布于慕课网 ，转载请注明出处，谢谢合作